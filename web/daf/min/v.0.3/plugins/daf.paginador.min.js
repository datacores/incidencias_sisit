(function(l){Paginador=function(){var b=Array.prototype.slice.call(arguments,0),a;this.contenedor=b[0];this.$c=$(b[0]);a=_.isBoolean(b[1])&&!0===b[1]?2:1;2!==a&&this.$c.html(this.get_html());this.url=(this.datos=_.isArray(b[a])?b[a]:!1)?!1:b[a];this.callback=b[a+1]||function(a){console.log("Callback por defecto:");console.debug(a)};this.controles={regs_x_pag:$(this.contenedor+" #regs_x_pag"),btn_pags:this.$c.find(".pag_control")};this.info={primero:$(this.contenedor+" #primero"),ultimo:$(this.contenedor+
" #ultimo"),total:$(this.contenedor+" #total")};this.intervalo=parseInt($(this.contenedor+" #regs_x_pag").val());this.refrescar()};Paginador.prototype.refrescar=function(){this.set_info(1,this.intervalo,this.datos.length);this.comportamientos_ctrls();this.controles.regs_x_pag.trigger("change")};Paginador.prototype.set_datos=function(b){if(_.isArray(b))this.datos=b;else throw"Los datos pasados para paginar deben de ser una colecci\u00f3n(Array de objetos)";};Paginador.prototype.set_callback=function(b){this.callback=
b};Paginador.prototype.get_html=function(){return'<div style="width: 33%;float: left;"> \r\n\t\t            <span> \r\n\t\t                Mostrar&nbsp;&nbsp; \r\n\t\t                <select id="regs_x_pag"> \r\n\t\t                    <option value="10"> 10 </option> \r\n\t\t                    <option value="20"> 20 </option> \r\n\t\t                    <option value="50"> 50 </option> \r\n\t\t                    <option value="70"> 70 </option> \r\n\t\t                    <option value="100"> 100 </option> \r\n\t\t                </select> \r\n\t\t                &nbsp;&nbsp;registros \r\n\t\t            </span> \r\n\t\t        </div> \r\n\t\t        <div style="width: 34%;float: left;"> \r\n\t\t            <div style="margin-top: 6px;text-align: center;"> \r\n\t\t                Mostrando  \r\n\t\t                <span id="primero">&nbsp;</span> a  \r\n\t\t                <span id="ultimo">&nbsp;</span> de  \r\n\t\t                <span id="total">&nbsp;</span> Solicitudes \r\n\t\t            </div> \r\n\t\t        </div> \r\n\t\t        <div style="width: 33%;float: right;"> \r\n\t\t            <ul style="float: right;margin: 0px;"> \r\n\t\t                <li class="inactivo"> \r\n\t\t                    <a class="pag_control" id="prev"> \r\n\t\t                        << Previa \r\n\t\t                    </a> \r\n\t\t                </li> \r\n\t\t                <li class="activo"> \r\n\t\t                    <a class="pag_control" id="1">1</a> \r\n\t\t                </li> \r\n\t\t                <li> \r\n\t\t                    <a class="pag_control" id="2">2</a> \r\n\t\t                </li> \r\n\t\t                <li> \r\n\t\t                    <a class="pag_control" id="3">3</a> \r\n\t\t                </li> \r\n\t\t                <li> \r\n\t\t                    <a class="pag_control" id="4">4</a> \r\n\t\t                </li> \r\n\t\t                <li> \r\n\t\t                    <a class="pag_control" id="next"> \r\n\t\t                        Siguiente >> \r\n\t\t                    </a> \r\n\t\t                </li> \r\n\t\t            </ul> \r\n\t\t        </div>'};
Paginador.prototype.comportamientos_ctrls=function(){var b=this;this.controles.btn_pags.off("click");this.controles.btn_pags.on("click",function(a){var d=$(a.currentTarget).parent();d.hasClass("activo")||d.hasClass("inactivo")||b.paginar(a.currentTarget)});this.controles.regs_x_pag.off("change");this.controles.regs_x_pag.on("change",function(a){b.paginar(a.currentTarget)})};Paginador.prototype.set_controles=function(){for(var b=$(this.lanzador),a=this.controles.btn_pags.length,d={prev:$(this.controles.btn_pags[0]).parent().hasClass("inactivo")?
!1:!0,btns:[],next:$(this.controles.btn_pags[a]).parent().hasClass("inactivo")?!1:!0},c={prev:!1,btns:[],next:!1},g=this.total_paginas,e=a-2,f=a-3,a=1;a<this.controles.btn_pags.length-1;a++)d.btns.push(parseInt($(this.controles.btn_pags[a]).html()));if(isNaN(parseInt(b.attr("id")))){var h;if("regs_x_pag"===b.attr("id")){for(a=0;a<e;)a<g?c.btns[a]=++a:c.btns[a++]=!1;c.prev=!1;c.next=!1===c.btns[f]||c.btns[f]+1>g?!1:!0}else if("prev"===b.attr("id")){h=d.btns[0]-1;b=h-e+1;for(a=0;b<=h;)c.btns[a++]=b++;
c.prev=1<c.btns[0]?!0:!1;c.next=c.btns[f]+1<=g?!0:!1}else if("next"===b.attr("id")){b=d.btns[f]+1;for(a=0;a<e;)b+a<=g?c.btns[a]=b+a++:c.btns[a++]=!1;c.prev=e<c.btns[0]?!0:!1;c.next=!1===c.btns[f]||c.btns[f]+1>g?!1:!0}}else this.marcar_activa(b.attr("id"));if(0===c.btns.length)c=d;else{this.$c.find("li").removeClass("activo").addClass("inactivo");c.prev&&$(this.controles.btn_pags[0]).parent().removeClass("inactivo");c.next&&$(this.controles.btn_pags[this.controles.btn_pags.length-1]).parent().removeClass("inactivo");
for(a=0;a<e;)f=(d=c.btns[a]?!0:!1)?c.btns[a]:c.btns[a-1]+1,b=$(this.controles.btn_pags[a+1]),isNaN(f)&&(f=a+1),c.btns[a++]=f,b.html(f),d&&b.parent().removeClass("inactivo");0<g&&this.marcar_activa(1)}return c.btns[0]};Paginador.prototype.marcar_activa=function(b){this.$c.find("li").removeClass("activo");$(this.controles.btn_pags[parseInt(b)]).parent().addClass("activo")};Paginador.prototype.set_info=function(){var b=Array.prototype.slice.call(arguments,0);this.info.primero.html(b[0]);this.info.ultimo.html(b[1]);
this.info.total.html(b[2])};Paginador.prototype.paginar=function(b){b&&(this.lanzador=b);$lanzador=$(this.lanzador);var a=l.tipo(this.lanzador);b=$lanzador.attr("id");var d=this.controles.btn_pags.length-2;"HTMLAnchorElement"===a?(a=$lanzador.html(),"next"===b&&(a=parseInt($(this.controles.btn_pags[1]).html())+d),"prev"==b&&(a=parseInt($(this.controles.btn_pags[1]).html())-d),this.get_pagina(!1,a)):"HTMLSelectElement"===a&&this.get_pagina($lanzador.val(),1)};Paginador.prototype.get_pagina=function(){var b=
Array.prototype.slice.call(arguments,0),a=parseInt(b[0])||this.intervalo,d=b[1]||this.pagina_actual,b=b[2]||this.datos,c=parseInt((d-1)*a+1),g=parseInt((d-1)*a+a),e=0,f=[],h=c-1,k=this;this.intervalo=a;this.pagina_actual=d;if(this.datos){e=b.length;c>e&&(c=e);for(g>e&&(g=e);h<g;)f.push(b[h]),h++;this.total_paginas=Math.ceil(e/a);this.set_controles();this.set_info(c,g,e);this.callback(f)}this.url&&$.ajax({url:this.url,type:"POST",data:{primero:c,intervalo:a}}).done(function(b){b=JSON.parse(b);f=b.datos;
e=b.total;k.total_paginas=Math.ceil(e/a);k.set_controles(k.lanzador);k.set_info(c,g,e);k.callback(f)}).fail(function(a){console.log(a)})}})(DAF.API);
